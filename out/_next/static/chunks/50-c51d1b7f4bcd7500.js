"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{40861:function(e,t,r){r.d(t,{Z:function(){return B}});var n=r(85893),i=r(34051),s=r.n(i),o=r(67294),a=r(3857),l=r(99755),c=r(13131),d=r(50112),u=r(10745),h=r(53341),x=r(57558),f=r(468),m=r(85102),v=r(14257),g=r(29355),j=r(80471),p=r(5434),k=r(89583),y=r(8193),w=r(66982),b=r.n(w),N=r(30381),C=r.n(N),z=r(83078),Z=r(41664),S=r(48444),q=r(74922),M=r(47516);function E(e,t,r,n,i,s,o){try{var a=e[s](o),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(n,i)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){E(s,n,i,o,a,"next",e)}function a(e){E(s,n,i,o,a,"throw",e)}o(void 0)}))}}var A="https://mumbai.polygonscan.com/address/".concat(S.i.j,"#readContract"),L=function(e){var t,r,i,w,N=(0,a.rZ)(),S=(0,g.n)().width,E=(0,o.useState)(!1),L=E[0],G=E[1],_=(0,o.useState)(!1),B=_[0],H=_[1],O=(0,o.useState)(!1),P=O[0],D=O[1],I=(0,o.useState)(!1),F=I[0],U=I[1],Y=(0,o.useState)(0),K=Y[0],R=Y[1],V=(0,o.useState)(0),J=V[0],Q=V[1],W=function(){var e=(0,z.Nr)().user,t=(0,z.Oc)("NewUser",(function(t){return t.equalTo("userAddress",null===e||void 0===e?void 0:e.get("ethAddress")).limit(1)}),[null===e||void 0===e?void 0:e.get("ethAddress")]).data;return(0,o.useMemo)((function(){return!!t[0]}),[t])}(),X=(0,z.Nr)().user,$=(0,z.Oc)("NewUser",(function(t){return t.equalTo("userName",e.userName).limit(1)})),ee=$.data,te=($.isLoading,$.isFetching,(0,z.Oc)("_User",(function(e){var t;return e.equalTo("ethAddress",null===(t=ee[0])||void 0===t?void 0:t.get("userAddress")).limit(1)}),[ee]),(0,z.Oc)("NewUser",(function(e){return e.equalTo("userAddress",null===X||void 0===X?void 0:X.get("ethAddress")).limit(1)}),[ee])),re=(0,z.Oc)("NewGreet",(function(t){return t.equalTo("uid",e.id)}),[],{live:!0}),ne=(0,o.useCallback)((function(){ee[0]&&re.data[0]&&X&&re.data[0].relation("likes").query().equalTo("userAddress",X.get("ethAddress")).first().then((function(e){U(!!e),console.log(e)}))}),[ee,re.data,X]);(0,o.useEffect)((function(){ne()}),[ee,re.data,ne]),(0,o.useEffect)((function(){re.data[0]&&(re.data[0].relation("likes").query().count().then((function(e){R(e)})),re.data[0].relation("view").query().count().then((function(e){Q(e)})))}),[re.data]),(0,o.useEffect)((function(){var e=function(){var e=T(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=re.data[0],te.data[0]&&t.relation("view").add(te.data[0]),e.next=4,null===t||void 0===t?void 0:t.save();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var ie=null===(t=e.images)||void 0===t?void 0:t.map((function(e){return{original:e}})),se=function(e){return(0,n.jsx)(l.k,{onClick:e.onClick,sx:{":hover":{color:N.white}},children:(0,n.jsxs)(c.Z,{align:"center",children:[e.icon,(0,n.jsx)(d.x,{size:"sm",children:e.count})]})})},oe=function(){var e=T(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W){e.next=4;break}return(0,q.yK)("registerError"),(0,q.c0)({id:"registerError",title:"Error",message:"Register or log in to like post",autoClose:2500,disallowClose:!0,color:"red",icon:(0,n.jsx)(M.Cw1,{size:"100%"})}),e.abrupt("return");case 4:if(t=re.data[0],!te.data[0]||F){e.next=11;break}return t.relation("likes").add(te.data[0]),e.next=9,t.save();case 9:e.next=14;break;case 11:return t.relation("likes").remove(te.data[0]),e.next=14,t.save();case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){S<900?(G(!0),D(!1)):(G(!1),H(!1))}),[S]),(0,n.jsxs)(c.Z,{position:"center",children:[(0,n.jsx)(u.x,{my:"md",style:{width:S<=N.breakpoints.sm?"100%":"70%"},children:(0,n.jsxs)(h.Z,{p:"lg",style:{backgroundColor:N.colors.dark[9],border:"1px solid",borderColor:N.colors.gray[7]},children:[(0,n.jsxs)(c.Z,{position:"apart",children:[(0,n.jsx)(Z.default,{href:"/profile/".concat(null===(r=ee[0])||void 0===r?void 0:r.get("uid")),passHref:!0,children:(0,n.jsxs)(c.Z,{style:{cursor:"pointer"},children:[(0,n.jsx)(x.q,{radius:"lg",color:"dark",size:50,src:null===(w=null===(i=ee[0])||void 0===i?void 0:i.get("profile_pic"))||void 0===w?void 0:w.url(),children:(0,n.jsx)(j.Mdg,{size:"100%"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d.x,{color:"white",weight:500,children:e.userName}),(0,n.jsx)(d.x,{size:"sm",style:{color:N.colors.gray[6],lineHeight:1.5},children:C()(1e3*parseInt(e.timestamp)).format("Do MMMM YYYY")}),(0,n.jsx)(d.x,{size:"sm",style:{color:N.colors.gray[6],lineHeight:1.5},children:C()(1e3*parseInt(e.timestamp)).format("h:mm:ss a")})]})]})}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)("div",{children:(0,n.jsxs)(d.x,{size:"xs",style:{color:N.colors.gray[6],lineHeight:1.5},children:["GreetID: ",e.id]})}),(0,n.jsxs)(f.v,{position:"left",size:"xl",mr:"sm",onClick:function(){!0===L&&(H(!0),D(!1))},opened:P,onOpen:function(){return D(!0)},onClose:function(){return D(!1)},children:[(0,n.jsx)(f.v.Label,{children:"Greet menu"}),(0,n.jsx)("a",{href:A,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(f.v.Item,{icon:(0,n.jsx)(y.KP3,{size:20}),children:"Verify this Greet"})})]})]})]}),(0,n.jsx)(u.x,{my:"sm",children:(0,n.jsx)(m.o,{maxHeight:120,hideLabel:"Hide",showLabel:"Show more",children:(0,n.jsx)(d.x,{color:"white",size:"sm",style:{whiteSpace:"pre-line"},children:e.textContent})})}),(0,n.jsx)(h.Z.Section,{children:ie&&(0,n.jsx)(b(),{items:ie||[],showThumbnails:!1,showBullets:!!ie&&ie.length>1,showPlayButton:!1,showFullscreenButton:!1,showNav:S>N.breakpoints.sm,renderLeftNav:function(e,t){return(0,n.jsx)(l.k,{type:"button",className:"image-gallery-icon image-gallery-left-nav",disabled:t,onClick:e,"aria-label":"Previous Slide",sx:{height:"100%"},children:(0,n.jsx)(y.CF5,{size:20})})},renderRightNav:function(e,t){return(0,n.jsx)(l.k,{type:"button",className:"image-gallery-icon image-gallery-right-nav",disabled:t,onClick:e,"aria-label":"Next Slide",sx:{height:"100%"},children:(0,n.jsx)(y.Td4,{size:20})})}})}),(0,n.jsx)(u.x,{children:(0,n.jsx)(c.Z,{position:"center",children:(0,n.jsxs)(c.Z,{position:"apart",mx:"xs",px:"lg",mt:"lg",style:{width:"100%"},children:[(0,n.jsx)(se,{icon:(0,n.jsx)(p.tVv,{size:20,className:"feedButton",color:F?"red":"none"}),count:K,onClick:oe}),(0,n.jsx)(se,{icon:(0,n.jsx)(k.DCG,{size:20,className:"feedButton"}),count:0}),(0,n.jsxs)(c.Z,{align:"center",children:[(0,n.jsx)(k.dSq,{size:20,className:"feedButton"}),(0,n.jsx)(d.x,{size:"sm",children:J})]})]})})})]})}),(0,n.jsx)(v.d,{opened:B,onClose:function(){return H(!1)},position:"bottom",size:"md",title:"Greet Menu",children:(0,n.jsx)(c.Z,{position:"center",style:{width:"100%"},children:(0,n.jsx)("a",{href:A,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(l.k,{sx:{width:"100%","&:hover":{backgroundColor:N.colors.dark[5]}},p:"md",children:(0,n.jsxs)(c.Z,{position:"left",children:[(0,n.jsx)(y.KP3,{}),(0,n.jsx)(d.x,{size:"sm",children:"Verify this Greet"})]})})})})})]})},G=r(58533),_=function(e){return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(u.x,{children:(0,n.jsx)(G.Z,{dataLength:_.length,next:e.fetchMore,hasMore:e.hasMore,loader:(0,n.jsx)("h3",{style:{color:"black"},children:" Loading..."}),endMessage:(0,n.jsx)("h4",{style:{color:"black"},children:"Nothing more to show"}),children:e.feeds.map((function(e){return(0,n.jsx)(L,{userName:e.userName,id:e.id,timestamp:e.timestamp,textContent:e.textContent,images:e.images,video:e.video},e.id)}))})})})},B=_},83025:function(e,t,r){r.d(t,{D:function(){return n}});var n={Trending:"TRENDING",Latest:"Latest"}}}]);