"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{40861:function(e,r,t){t.d(r,{Z:function(){return H}});var n=t(85893),i=t(34051),s=t.n(i),o=t(67294),a=t(3857),l=t(99755),c=t(13131),d=t(50112),u=t(10745),h=t(53341),x=t(57558),f=t(468),m=t(85102),g=t(14257),v=t(29355),j=t(80471),p=t(5434),k=t(89583),y=t(8193),w=t(66982),b=t.n(w),N=t(30381),C=t.n(N),z=t(83078),Z=t(41664),S=t(48444),q=t(74922),M=t(47516);function E(e,r,t,n,i,s,o){try{var a=e[s](o),l=a.value}catch(c){return void t(c)}a.done?r(l):Promise.resolve(l).then(n,i)}function L(e){return function(){var r=this,t=arguments;return new Promise((function(n,i){var s=e.apply(r,t);function o(e){E(s,n,i,o,a,"next",e)}function a(e){E(s,n,i,o,a,"throw",e)}o(void 0)}))}}var T="https://mumbai.polygonscan.com/address/".concat(S.i.j,"#readContract"),A=function(e){var r,t,i,w,N=(0,a.rZ)(),S=(0,v.n)().width,E=(0,o.useState)(!1),A=E[0],G=E[1],_=(0,o.useState)(!1),H=_[0],P=_[1],B=(0,o.useState)(!1),I=B[0],O=B[1],D=(0,o.useState)(!1),F=D[0],Y=D[1],K=(0,o.useState)(0),R=K[0],U=K[1],V=(0,o.useState)(0),J=V[0],Q=V[1],W=function(){var e=(0,z.Nr)().user,r=(0,z.Oc)("NewUser",(function(r){return r.equalTo("userAddress",null===e||void 0===e?void 0:e.get("ethAddress")).limit(1)}),[null===e||void 0===e?void 0:e.get("ethAddress")]).data;return(0,o.useMemo)((function(){return!!r[0]}),[r])}(),X=(0,z.Nr)().user,$=(0,z.Oc)("NewUser",(function(r){return r.equalTo("userName",e.userName).limit(1)})),ee=$.data,re=($.isLoading,$.isFetching,(0,z.Oc)("NewUser",(function(e){return e.equalTo("userAddress",null===X||void 0===X?void 0:X.get("ethAddress")).limit(1)}),[ee])),te=(0,z.Oc)("NewGreet",(function(r){return r.equalTo("uid",e.id)}),[],{live:!0}),ne=(0,o.useCallback)((function(){ee[0]&&te.data[0]&&X&&te.data[0].relation("likes").query().equalTo("userAddress",X.get("ethAddress")).first().then((function(e){Y(!!e),console.log(e)}))}),[ee,te.data,X]);(0,o.useEffect)((function(){ne()}),[ee,te.data,ne]),(0,o.useEffect)((function(){te.data[0]&&(te.data[0].relation("likes").query().count().then((function(e){U(e)})),te.data[0].relation("view").query().count().then((function(e){Q(e)})))}),[te.data]),(0,o.useEffect)((function(){var e=function(){var e=L(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=te.data[0],re.data[0]&&r.relation("view").add(re.data[0]),e.next=4,null===r||void 0===r?void 0:r.save();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var ie=null===(r=e.images)||void 0===r?void 0:r.map((function(e){return{original:e}})),se=function(e){return(0,n.jsx)(l.k,{onClick:e.onClick,sx:{":hover":{color:N.white}},children:(0,n.jsxs)(c.Z,{align:"center",children:[e.icon,(0,n.jsx)(d.x,{size:"sm",children:e.count})]})})},oe=function(){var e=L(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W){e.next=4;break}return(0,q.yK)("registerError"),(0,q.c0)({id:"registerError",title:"Error",message:"Register or log in to like post",autoClose:2500,disallowClose:!0,color:"red",icon:(0,n.jsx)(M.Cw1,{size:"100%"})}),e.abrupt("return");case 4:if(Y(!0),r=te.data[0],!re.data[0]||F){e.next=12;break}return r.relation("likes").add(re.data[0]),e.next=10,r.save();case 10:e.next=15;break;case 12:return r.relation("likes").remove(re.data[0]),e.next=15,r.save();case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){S<900?(G(!0),O(!1)):(G(!1),P(!1))}),[S]),(0,n.jsxs)(c.Z,{position:"center",children:[(0,n.jsx)(u.x,{my:"md",style:{width:S<=N.breakpoints.sm?"100%":"70%"},children:(0,n.jsxs)(h.Z,{p:"lg",style:{backgroundColor:N.colors.dark[9],border:"1px solid",borderColor:N.colors.gray[7]},children:[(0,n.jsxs)(c.Z,{position:"apart",children:[(0,n.jsx)(Z.default,{href:{pathname:"profile",query:{id:null===(t=ee[0])||void 0===t?void 0:t.get("uid")}},passHref:!0,children:(0,n.jsxs)(c.Z,{style:{cursor:"pointer"},children:[(0,n.jsx)(x.q,{radius:"lg",color:"dark",size:50,src:null===(w=null===(i=ee[0])||void 0===i?void 0:i.get("profile_pic"))||void 0===w?void 0:w.url(),children:(0,n.jsx)(j.Mdg,{size:"100%"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d.x,{color:"white",weight:500,children:e.userName}),(0,n.jsx)(d.x,{size:"sm",style:{color:N.colors.gray[6],lineHeight:1.5},children:C()(1e3*parseInt(e.timestamp)).format("Do MMMM YYYY")}),(0,n.jsx)(d.x,{size:"sm",style:{color:N.colors.gray[6],lineHeight:1.5},children:C()(1e3*parseInt(e.timestamp)).format("h:mm:ss a")})]})]})}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)("div",{children:(0,n.jsxs)(d.x,{size:"xs",style:{color:N.colors.gray[6],lineHeight:1.5},children:["GreetID: ",e.id]})}),(0,n.jsxs)(f.v,{position:"left",size:"xl",mr:"sm",onClick:function(){!0===A&&(P(!0),O(!1))},opened:I,onOpen:function(){return O(!0)},onClose:function(){return O(!1)},children:[(0,n.jsx)(f.v.Label,{children:"Greet menu"}),(0,n.jsx)("a",{href:T,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(f.v.Item,{icon:(0,n.jsx)(y.KP3,{size:20}),children:"Verify this Greet"})})]})]})]}),(0,n.jsx)(u.x,{my:"sm",children:(0,n.jsx)(m.o,{maxHeight:120,hideLabel:"Hide",showLabel:"Show more",children:(0,n.jsx)(d.x,{color:"white",size:"sm",style:{whiteSpace:"pre-line"},children:e.textContent})})}),(0,n.jsx)(h.Z.Section,{children:ie&&(0,n.jsx)(b(),{items:ie||[],showThumbnails:!1,showBullets:!!ie&&ie.length>1,showPlayButton:!1,showFullscreenButton:!1,showNav:S>N.breakpoints.sm,renderLeftNav:function(e,r){return(0,n.jsx)(l.k,{type:"button",className:"image-gallery-icon image-gallery-left-nav",disabled:r,onClick:e,"aria-label":"Previous Slide",sx:{height:"100%"},children:(0,n.jsx)(y.CF5,{size:20})})},renderRightNav:function(e,r){return(0,n.jsx)(l.k,{type:"button",className:"image-gallery-icon image-gallery-right-nav",disabled:r,onClick:e,"aria-label":"Next Slide",sx:{height:"100%"},children:(0,n.jsx)(y.Td4,{size:20})})}})}),(0,n.jsx)(u.x,{children:(0,n.jsx)(c.Z,{position:"center",children:(0,n.jsxs)(c.Z,{position:"left",mx:"xs",px:"lg",mt:"lg",style:{width:"100%"},children:[(0,n.jsx)(se,{icon:(0,n.jsx)(p.tVv,{size:20,className:"feedButton",color:F?"red":"none"}),count:R,onClick:oe}),(0,n.jsxs)(c.Z,{align:"center",children:[(0,n.jsx)(k.dSq,{size:20,className:"feedButton"}),(0,n.jsx)(d.x,{size:"sm",children:J})]})]})})})]})}),(0,n.jsx)(g.d,{opened:H,onClose:function(){return P(!1)},position:"bottom",size:"md",title:"Greet Menu",children:(0,n.jsx)(c.Z,{position:"center",style:{width:"100%"},children:(0,n.jsx)("a",{href:T,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(l.k,{sx:{width:"100%","&:hover":{backgroundColor:N.colors.dark[5]}},p:"md",children:(0,n.jsxs)(c.Z,{position:"left",children:[(0,n.jsx)(y.KP3,{}),(0,n.jsx)(d.x,{size:"sm",children:"Verify this Greet"})]})})})})})]})},G=t(58533),_=function(e){return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(u.x,{children:(0,n.jsx)(G.Z,{dataLength:_.length,next:e.fetchMore,hasMore:e.hasMore,loader:(0,n.jsx)("h3",{style:{color:"black"},children:" Loading..."}),endMessage:(0,n.jsx)("h4",{style:{color:"black"},children:"Nothing more to show"}),children:e.feeds.map((function(e){return(0,n.jsx)(A,{userName:e.userName,id:e.id,timestamp:e.timestamp,textContent:e.textContent,images:e.images,video:e.video},e.id)}))})})})},H=_},83025:function(e,r,t){t.d(r,{D:function(){return n}});var n={Trending:"TRENDING",Latest:"Latest"}}}]);