(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[192],{58932:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/[id]",function(){return n(24505)}])},24505:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return L}});var r=n(34051),i=n.n(r),o=n(85893),s=n(67294),u=n(41664),l=n(88852),d=n(41181),c=n(11163),a=n(3857),f=n(53341),v=n(13131),g=n(50112),h=n(6076),m=n(57558),x=n(10745),p=n(8193),w=n(80471),j=n(3056),y=n(81621),k=n(49680),C=n.n(k);function b(e,t,n,r,i,o,s){try{var u=e[o](s),l=u.value}catch(d){return void n(d)}u.done?t(l):Promise.resolve(l).then(r,i)}function z(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){b(o,r,i,s,u,"next",e)}function u(e){b(o,r,i,s,u,"throw",e)}s(void 0)}))}}function A(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function E(){var e=A(["\n\t\t\tquery ProofQuery($from: String!, $to: String!) {\n\t\t\t\tconnections(fromAddr: $from, toAddrList: [$to], network: ETH) {\n\t\t\t\t\tfollowStatus {\n\t\t\t\t\t\tisFollowed\n\t\t\t\t\t\tisFollowing\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t"]);return E=function(){return e},e}function N(){var e=A(["\n\t\t\tquery IdentityQuery($address: String!) {\n\t\t\t\tidentity(address: $address, network: ETH) {\n\t\t\t\t\tfollowingCount\n\t\t\t\t\tfollowerCount\n\t\t\t\t}\n\t\t\t}\n\t\t"]);return N=function(){return e},e}var T=function(e){var t,n,r=(0,a.rZ)(),c=(0,s.useState)(!1),b=c[0],A=c[1],T=function(){var e=(0,s.useState)(),t=e[0],n=e[1];return(0,s.useEffect)((function(){if(window.ethereum){var e=new(C())({namespace:"CyberConnect",env:k.Env.PRODUCTION,chain:k.Blockchain.ETH,provider:window.ethereum,signingMessageEntity:"Greet"});n(e),console.log(e)}}),[]),t}(),_=(0,j.a)((0,y.Ps)(E()),{variables:{from:e.from,to:e.to}}),P=(0,j.a)((0,y.Ps)(N()),{variables:{address:e.to}}),S=(0,s.useMemo)((function(){var e,t,n;return null===(t=null===(e=_.data)||void 0===e?void 0:e.connections[0])||void 0===t||null===(n=t.followStatus)||void 0===n?void 0:n.isFollowing}),[_]),F=function(){var t=z(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return A(!0),t.next=3,null===T||void 0===T?void 0:T.connect(e.to,k.ConnectionType.FOLLOW);case 3:return t.next=5,_.refetch();case 5:return t.next=7,P.refetch();case 7:A(!1);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),O=function(){var t=z(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return A(!0),t.next=3,null===T||void 0===T?void 0:T.disconnect(e.to,k.ConnectionType.FOLLOW);case 3:return t.next=5,_.refetch();case 5:return t.next=7,P.refetch();case 7:A(!1);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),q=function(e){var t=e.followed;return(0,o.jsx)(o.Fragment,{children:t||void 0===t?(0,o.jsx)(l.z,{variant:"outline",onClick:O,hidden:void 0===t,loading:b,children:"Followed"}):(0,o.jsx)(l.z,{variant:"outline",onClick:F,hidden:void 0===t,loading:b,children:"Follow"})})};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(f.Z,{p:"lg",style:{backgroundColor:r.colors.dark[9],border:"1px solid",borderColor:r.colors.gray[7]},radius:"lg",mt:"sm",children:[(0,o.jsxs)(v.Z,{position:"apart",align:"center",mb:"sm",children:[(0,o.jsx)(g.x,{size:"lg",weight:"bold",align:"center",children:"Profile"}),e.self&&(0,o.jsx)(u.default,{href:"/profile/setting",passHref:!0,children:(0,o.jsx)(h.A,{mr:"sm",size:"xl",children:(0,o.jsx)(p.zPD,{size:30})})})]}),(0,o.jsx)(v.Z,{position:"center",align:"flex-start",children:(0,o.jsxs)(v.Z,{direction:"column",position:"center",align:"center",children:[(0,o.jsx)(m.q,{radius:"lg",color:"dark",mb:"sm",size:80,src:e.image,children:(0,o.jsx)(w.Mdg,{size:"100%"})}),(0,o.jsx)(d.D,{order:5,children:e.userName}),e.description&&(0,o.jsx)(g.x,{size:"sm",children:e.description}),!e.self&&!_.loading&&(0,o.jsx)(q,{followed:S})]})}),(0,o.jsxs)(v.Z,{position:"center",mt:"md",children:[(0,o.jsxs)(x.x,{children:[(0,o.jsx)(g.x,{size:"sm",weight:"bold",align:"center",children:e.greetCount}),(0,o.jsx)(g.x,{size:"sm",align:"center",children:"Greets"})]}),(0,o.jsx)(u.default,{href:"/profile/followers/".concat(e.id),passHref:!0,children:(0,o.jsxs)(x.x,{style:{cursor:"pointer"},children:[(0,o.jsx)(g.x,{size:"sm",weight:"bold",align:"center",children:(null===(t=P.data)||void 0===t?void 0:t.identity.followerCount)||0}),(0,o.jsx)(g.x,{size:"sm",align:"center",children:"Followers"})]})}),(0,o.jsx)(u.default,{href:"/profile/following/".concat(e.id),passHref:!0,children:(0,o.jsxs)(x.x,{style:{cursor:"pointer"},children:[(0,o.jsx)(g.x,{size:"sm",weight:"bold",align:"center",children:(null===(n=P.data)||void 0===n?void 0:n.identity.followingCount)||0}),(0,o.jsx)(g.x,{size:"sm",align:"center",children:"Following"})]})})]})]})})},_=n(83078),P=n(40861),S=n(83025),F=n(9669),O=n.n(F);function q(e,t,n,r,i,o,s){try{var u=e[o](s),l=u.value}catch(d){return void n(d)}u.done?t(l):Promise.resolve(l).then(r,i)}function H(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){q(o,r,i,s,u,"next",e)}function u(e){q(o,r,i,s,u,"throw",e)}s(void 0)}))}}var L=function(){var e,t=(0,c.useRouter)().query.id,n=(0,s.useState)(0),r=n[0],a=n[1],f=(0,_.Nr)(),v=f.Moralis,g=f.isInitialized,h=(f.isInitializing,f.user),m=(f.isAuthenticating,(0,s.useState)("")),x=(m[0],m[1],(0,s.useState)("")),p=x[0],w=x[1],j=(0,s.useState)(!1),y=(j[0],j[1],(0,s.useState)(!1)),k=y[0],C=y[1],b=(0,s.useState)(),z=b[0],A=b[1],E=(0,s.useState)(void 0),N=E[0],F=E[1],q=(0,_.Oc)("NewGreet",(function(e){return e.equalTo("creator",null===N||void 0===N?void 0:N.get("userAddress")).notEqualTo("uri","").descending("timestamp_decimal").limit(10)}),[null===N||void 0===N?void 0:N.get("userAddress")]),L=q.data,Z=q.isLoading,M=(0,_.Oc)("_User",(function(e){return e.equalTo("ethAddress",null===N||void 0===N?void 0:N.get("userAddress")).limit(1)}),[null===N||void 0===N?void 0:N.get("userAddress")]),$=(0,s.useCallback)(H(i().mark((function e(){var n,r,o,s,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=14;break}return n=new v.Query("NewUser"),e.next=4,n.equalTo("uid",t).first();case 4:return r=e.sent,w(null===r||void 0===r?void 0:r.get("userName")),F(r),o=new v.Query("NewGreet"),e.next=10,o.equalTo("creator",null===r||void 0===r?void 0:r.get("userAddress")).notEqualTo("uri","").count();case 10:s=e.sent,a(s),u=(null===h||void 0===h?void 0:h.get("ethAddress"))===(null===r||void 0===r?void 0:r.get("userAddress")),C(u);case 14:case"end":return e.stop()}}),e)}))),[g,v.Query,t,h]);(0,s.useEffect)((function(){$()}),[h,$]);var D=(0,s.useCallback)(H(i().mark((function e(){var t,n,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(L.map((function(e){return O().get(e.get("uri"))})));case 2:t=e.sent,n=L.map((function(e){return e.get("uid")})),r=L.map((function(e){return e.get("timestamp")})),o=t.map((function(e,t){var i,o=e.data;return{userName:o.creatorName,id:n[t],images:null===(i=o.images)||void 0===i?void 0:i.map((function(e){return e.URI})),textContent:o.text,timestamp:r[t]}})),A(o);case 7:case"end":return e.stop()}}),e)}))),[L]);return(0,s.useEffect)((function(){console.log(L),D()}),[L,D]),(0,s.useEffect)((function(){var e;M.isLoading||console.log(null===(e=M.data[0])||void 0===e?void 0:e.get("ethAddress"))}),[M.data]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.default,{href:"/",passHref:!0,children:(0,o.jsx)(l.z,{variant:"outline",children:"Back"})}),(null===N||void 0===N?void 0:N.get("userAddress"))&&(null===h||void 0===h?void 0:h.get("ethAddress"))&&(0,o.jsx)(T,{userName:p,image:null===(e=null===N||void 0===N?void 0:N.get("profile_pic"))||void 0===e?void 0:e.url(),greetCount:r,description:null===N||void 0===N?void 0:N.get("description"),likeCount:0,self:k,id:t,from:null===h||void 0===h?void 0:h.get("ethAddress"),to:N.get("userAddress")}),L.length>0&&(0,o.jsxs)(d.D,{order:4,mt:"sm",ml:"sm",children:["All Greets from ",p]}),!Z&&(0,o.jsx)(P.Z,{feeds:z||[],filter:S.D.Trending,isFollowing:!0,hasMore:!1,fetchMore:function(){}})]})}},35883:function(){},71456:function(){},73105:function(){},55024:function(){}},function(e){e.O(0,[617,228,445,885,919,982,96,618,50,774,888,179],(function(){return t=58932,e(e.s=t);var t}));var t=e.O();_N_E=t}]);